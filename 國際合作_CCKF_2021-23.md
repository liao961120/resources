# /國際合作/CCKF 2021-23


<a href='https://drive.google.com/drive/folders/1u-zVAjwjM5yAN5EuqXqOPNnwvbaeVuwZ' target='_blank' class='drive-location'><code>/國際合作/CCKF 2021-23/data.scripts</code></a>

## **Chinese Text Project (CTEXT) digital library**

</br>

1. The Chinese Text Project includes 14123 texts/entries from 2 sections:

    Section | Number of entries
    ---------|----------
    book (原典) | 139
    wiki (維基) | 13984
    **Total** | 14123

    > * [Official Python wrapper - ctext](https://pypi.org/project/ctext/)
    > * [R library - ctextclassics](https://www.r-bloggers.com/ctextclassics-my-first-package/)

2. The meta retrieved from the API:

    - **`corpus/ctext/meta/`**`dynasties.json`: 26 dynasties info retrieved from [getdynasties](https://api.ctext.org/getdynasties)

        ```json
            {
                "dynasties": [
                    {
                    "id": "1",
                    "title": "Western Zhou",
                    "yearfrom": "-1046",
                    "yearto": "-771"
                    },
                    {
                    "id": "27",
                    "title": "Zhou",
                    "yearfrom": "-1046",
                    "yearto": "-221"
                    },
                    ...
                ]
            }
        ```
    - **`corpus/ctext/meta/`**`urns.json`

        ```json
            {
                "book": [
                    {
                    "title": "墨子",
                    "urn": "ctp:mozi"
                    },
                    {
                    "title": "論語",
                    "urn": "ctp:analects"
                    },
                    ...
                ],
                "wiki": [
                    {
                    "title": "古字通假會典中的通假字",
                    "urn": "ctp:wb4"
                    },
                    {
                    "title": "龍文鞭影",
                    "urn": "ctp:wb56254"
                    },
                    ...
                ]
            }
        ```
    - **`corpus/ctext/meta/`**`urns_selectedVers.json`
    
        ```json
            ["mozi","analects","mengzi","hanfeizi","zhuangzi","huainanzi","shiji","liji","mozi-jiangu","gongsunlongzi","dao-de-jing","xunzi","book-of-poetry","art-of-war","xiao-jing", ...]
        ```
    
1. The text retrieved from the API:

    content | main folder | file path | ttr
    ---------|----------|----------|----------
    raw data in json retrieved via API | **`large_files/ctext/data/raw/`** | **`book/`**`text_<index>_<ctp>_<title>.json` (139), **`wiki/`**`text_<index>_<ctp>_<title>.json` (31984)
    compressed raw data in json retrieved via API | **`corpus/ctext/data/raw/`** | **``book/``**`text_book_raw.gz`,  **``wiki/``**`text_wiki_raw.gz`,  **``wiki/``**`text_wiki_raw_part_<aa-ak>` (11)
    clean text with CJK symbols replaced by space | **`large_files/ctext/data/clean_sep_allVers_allChars/`** | **`book/`**`text_<index>_<ctp>_<title>.txt` (139), **`wiki/`**`text_<index>_<ctp>_<title>.txt` (31984)
    compressed clean text with CJK symbols replaced by space | **`corpus/ctext/data/clean_sep_allVers_allChars/`** | `text_book_clean_allVers_allChars.tar.gz`, `text_wiki_clean_allVers_allChars.tar.gz`, `text_wiki_clean_allVers_allChars_part_<aa-an>` (14)
    clean spaced text in one `.txt` file (all versions) | **`corpus/ctext/data/clean_spaced_allVers_allChars/`** | `<dynasty>_clean_spaced_allVers_allChars.txt` (6)|y
    clean spaced text in one `.txt` file (selected versions) | **`corpus/ctext/data/clean_spaced_selectedVers_allChars/`** | `<dynasty>_clean_spaced_selectedVers_allChars.txt` (5)|y
    clean seg text in one `.txt` file (all versions) | **`corpus/ctext/data/clean_seg_allVers_allChars/`** | `<dynasty>_clean_seg_allVers_allChars.txt` (1)|y
    > * Because the textual data are large in number and size, they are compressed into `book_text.tar.gz`, `wiki_text.tar.gz` and 17 spilt files starting with `wiki_text_part`. To merge the split files, use `cat wiki_text_part_* > wiki_text.tar.gz`, and then we will get `wiki_text.tar.gz` just like `book_text.tar.gz`.

2. The textinfo retrieved from the API:

    folder/file | content
    ---------|----------
    ~~**`text/`**`text_<index>_<ctp>_<title>.json`~~ | ~~individual text files~~
    `textinfo.json` | - a file of all textinfo </br> - in a list of nested dictionaries
    `textinfo_flatten.csv` | - a file of all textinfo </br> - flatten into a table
    `textinfo_flatten_TEXTDB_removed.csv` | - a file of all textinfo </br> - flatten into a table </br> - The tag TEXTDB is **not** allowed for wiki entries and removed accordingly.

    with the following exceptions marked with _X_:

    folder/file | **`book/`** | **`wiki/`**
    ---------|----------|----------
    ~~**`text/`**`text_<index>_<ctp>_<title>.json`~~ |
    `textinfo.json` |
    `textinfo_flatten.csv` |
    `textinfo_flatten_TEXTDB_removed.csv` | _X_ |

    </br>

    ```python
    # textinfo.json
    [
        {
            "index": 0,
            "textinfo": {
            "dynasty": {
                "from": {
                "id": "3",
                "name": "Spring and Autumn"
                },
                "to": {
                "id": "4",
                "name": "Warring States"
                }
            },
            "edition": {
                "collectionid": "132",
                "description": "太清部",
                "title": "正統道藏",
                "url": "http://ctext.org/library.pl?if=en&res=84851"
            },
            "lastmodified": "2015-12-07 20:42:56",
            "tags": [
                "TEXTDB"
            ],
            "title": "墨子",
            "toptitle": "墨子",
            "topurn": "ctp:mozi"
            }
        },
        {
            "index": 1,
            "textinfo": ...
        },
        ...
    ]
    ```

    ```python
    # headers in textinfo_flatten.csv
        ,
        index,
        textinfo_dynasty_from_id,
        textinfo_dynasty_from_name,
        textinfo_dynasty_to_id,
        textinfo_dynasty_to_name,
        textinfo_lastmodified,
        textinfo_title,
        textinfo_toptitle,
        textinfo_topurn,
        textinfo_author,
        textinfo_edition_collectionid,
        textinfo_edition_description,
        textinfo_edition_title,textinfo_edition_url,
        textinfo_tags,
        textinfo_tags_string
    ```
---
- **`stability/`**:

For each dynasty (Tang to 1980s)
1. lda:
    - `<dynasty>_lda_model`: model 
    - `<dynasty>_query_words.csv`: 20 query words with the highest mean probabilities
2. word2vec:
    - `<dynasty>_word2vec_iter_<iter_no>.model`: 50 bootstrap word2vec models
    - `stability_data.pkl`: 

        ```json
            {'王': {
                'iter_0': [
                    {'neighbor': '公', 'found': True, 'cos_sim': 0.426, 'rank': 6},
                    {'neighbor': '周', 'found': True, 'cos_sim': 0.415, 'rank': 10},
                    ...
                ],
                'iter_1': [
                    {'neighbor': '公', 'found': True, 'cos_sim': 0.403, 'rank': 2},
                    ...
        ```
    
    - `stability_data_t.pkl`
    - `stability_measure.json`
    - `query_word_家.csv`

1. Embeddings
- `allChars_SGNS_windowSize1`: data used in CLSW 2020, includes Dcard embeddings (2010s), TensorBoard demo
- `allChars_SGNS_windowSize1_v2`: analogical reasoning task
- `allChars_SGNS_windowSize5`: data used in thesis, analogical reasoning task (not sure about 1980s or 1980s_seg)
- `allChars_SGNS_windowSize10`: analogical reasoning task